/*!
 * AetherWarp
 * 
 * [AetherWarp - Public]{@link https://cdn.jsdelivr.net/gh/msentimental/AetherCipher@latest/build/aetherwarp.min.js}
 *
 * @version 1.0.0
 * @author msentimental [lijinhan2025@gmail.com]
 * @copyright Strike Bot Inc. 2026
 * @license See full license at https://github.com/MSentimental/AetherCipher/blob/main/LICENSE.md
 * 
 * Includes:
 *   - AetherWarp: An extremely lightweight, faster version of AetherHash for one-way hashing
 * 
 * [Usage examples]:
 *
 * <script>
 *   // initialize aetherWarp
 *   const warp = new AetherWarp();
 *   
 *   // hashing
 *   const warpHash = warp.hash256('Hello World!');
 *   console.log('Hash:', warpHash);
 *   
 *   // Benchmark
 *   AetherWarp.benchmark();
 * </script>
 */

class AetherWarp{constructor(){this.state=new Uint32Array(16),this.w=new Uint32Array(16),this.k=new Uint32Array(64),this._initConstants()}_initConstants(){const t=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311];for(let e=0;e<64;e++)this.k[e]=Math.floor(4294967296*Math.cbrt(t[e]))>>>0}hash(t){if(!t||'string'!=typeof t)throw new Error('AetherWarp: Input must be a non-empty string');const e=this.state;e[0]=1779033703,e[1]=3144134277,e[2]=1013904242,e[3]=2773480762,e[4]=1359893119,e[5]=2600822924,e[6]=528734635,e[7]=1541459225,e[8]=-197222434,e[9]=626054972,e[10]=-1571190069,e[11]=997756035,e[12]=-818336826,e[13]=87167285,e[14]=-2118868974,e[15]=-975719264;const r=(new TextEncoder).encode(t),n=r.length,s=8*n,o=2+(n+8>>6),h=new Uint8Array(o<<6);for(let t=0;t<n;t++)h[t]=r[t];h[n]=128,new DataView(h.buffer).setBigUint64((o<<6)-8,BigInt(s),!1);const w=this.w,k=this.k;for(let t=0;t<h.length;t+=64){const r=h;w[0]=r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3],w[1]=r[t+4]<<24|r[t+5]<<16|r[t+6]<<8|r[t+7],w[2]=r[t+8]<<24|r[t+9]<<16|r[t+10]<<8|r[t+11],w[3]=r[t+12]<<24|r[t+13]<<16|r[t+14]<<8|r[t+15],w[4]=r[t+16]<<24|r[t+17]<<16|r[t+18]<<8|r[t+19],w[5]=r[t+20]<<24|r[t+21]<<16|r[t+22]<<8|r[t+23],w[6]=r[t+24]<<24|r[t+25]<<16|r[t+26]<<8|r[t+27],w[7]=r[t+28]<<24|r[t+29]<<16|r[t+30]<<8|r[t+31],w[8]=r[t+32]<<24|r[t+33]<<16|r[t+34]<<8|r[t+35],w[9]=r[t+36]<<24|r[t+37]<<16|r[t+38]<<8|r[t+39],w[10]=r[t+40]<<24|r[t+41]<<16|r[t+42]<<8|r[t+43],w[11]=r[t+44]<<24|r[t+45]<<16|r[t+46]<<8|r[t+47],w[12]=r[t+48]<<24|r[t+49]<<16|r[t+50]<<8|r[t+51],w[13]=r[t+52]<<24|r[t+53]<<16|r[t+54]<<8|r[t+55],w[14]=r[t+56]<<24|r[t+57]<<16|r[t+58]<<8|r[t+59],w[15]=r[t+60]<<24|r[t+61]<<16|r[t+62]<<8|r[t+63];let n=e[0]^w[0],s=e[1]^w[1],o=e[2]^w[2],a=e[3]^w[3],i=e[4]^w[4],c=e[5]^w[5],l=e[6]^w[6],f=e[7]^w[7],p=e[8]^w[8],d=e[9]^w[9],u=e[10]^w[10],A=e[11]^w[11],g=e[12]^w[12],y=e[13]^w[13],m=e[14]^w[14],b=e[15]^w[15],x=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),W=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),C=n&s^n&o^s&o,U=i&c^~i&l,B=b+W+U+k[0]+w[0]>>>0,_=x+C>>>0;b=m,m=y,y=g,g=A,A=u,u=d,d=p,p=f,f=l,l=c,c=i,i=a+B>>>0,a=o,o=s,s=n,n=B+_>>>0,x=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),W=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),C=n&s^n&o^s&o,U=i&c^~i&l,B=b+W+U+k[1]+w[1]>>>0,_=x+C>>>0,b=m,m=y,y=g,g=A,A=u,u=d,d=p,p=f,f=l,l=c,c=i,i=a+B>>>0,a=o,o=s,s=n,n=B+_>>>0,x=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),W=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),C=n&s^n&o^s&o,U=i&c^~i&l,B=b+W+U+k[2]+w[2]>>>0,_=x+C>>>0,b=m,m=y,y=g,g=A,A=u,u=d,d=p,p=f,f=l,l=c,c=i,i=a+B>>>0,a=o,o=s,s=n,n=B+_>>>0,x=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),W=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),C=n&s^n&o^s&o,U=i&c^~i&l,B=b+W+U+k[3]+w[3]>>>0,_=x+C>>>0,b=m,m=y,y=g,g=A,A=u,u=d,d=p,p=f,f=l,l=c,c=i,i=a+B>>>0,a=o,o=s,s=n,n=B+_>>>0,e[0]^=n^w[0],e[1]^=s^w[1],e[2]^=o^w[2],e[3]^=a^w[3],e[4]^=i^w[4],e[5]^=c^w[5],e[6]^=l^w[6],e[7]^=f^w[7],e[8]^=p^w[8],e[9]^=d^w[9],e[10]^=u^w[10],e[11]^=A^w[11],e[12]^=g^w[12],e[13]^=y^w[13],e[14]^=m^w[14],e[15]^=b^w[15]}let a='';for(let t=0;t<16;t++){let r=e[t];a+=String.fromCharCode(r>>>24&255,r>>>16&255,r>>>8&255,255&r)}return this._bytesToHex(a)}_bytesToHex(t){const e=['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'];let r='';for(let n=0;n<t.length;n++)r+=e[t.charCodeAt(n)>>>4]+e[15&t.charCodeAt(n)];return r}hash256(t){return this.hash(t).substring(0,64)}hash512(t){return this.hash(t)}static async benchmark(t=104857600){const e=new AetherWarp,r='x'.repeat(t);for(let t=0;t<3;t++)e.hash256('warmup');let n=0;for(let t=0;t<5;t++){const s=performance.now(),hash=e.hash256(r);n+=performance.now()-s,0===t&&console.log(`Sample hash: ${hash.substring(0,32)}...`)}const s=(t/(n/5)/1024).toFixed(2);return console.log(`Speed: ${s} MB/s (${(s/1024).toFixed(2)} GB/s)`),s}}'undefined'!=typeof window&&(window.AetherWarp=AetherWarp),'undefined'!=typeof module&&(module.exports={AetherWarp:AetherWarp});
