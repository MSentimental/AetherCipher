/*!
 * AetherWarp
 * 
 * [AetherWarp - Public]{@link https://cdn.jsdelivr.net/gh/msentimental/AetherCipher@latest/build/aetherwarp.min.js}
 *
 * @version 1.2.0
 * @author msentimental [lijinhan2025@gmail.com]
 * @copyright Strike Bot Inc. 2026
 * @license See full license at https://github.com/MSentimental/AetherCipher/blob/main/LICENSE.md
 * 
 * Includes:
 *   - AetherWarp: An extremely simple and lightweight, faster version of AetherHash for one-way hashing
 * 
 * [Usage examples]:
 *
 * <script>
 *   // initialize aetherWarp
 *   const warp = new AetherWarp();
 *   
 *   // hashing
 *   const warpHash = warp.hash256('Hello World!');
 *   console.log('Hash:', warpHash);
 *   
 *   // Benchmark
 *   AetherWarp.benchmark();
 * </script>
 */

class AetherWarp{constructor(){this.k=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221]),this.iv=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),this.s=new Uint32Array(16)}_rotl(t,e){return t<<e|t>>>32-e}hash(t){if(!t||"string"!=typeof t)throw new Error("AetherWarp: Input must be a non-empty string");const e=(new TextEncoder).encode(t),r=e.length,o=8+(r+9+64-1&-64),n=new Uint8Array(o);for(let t=0;t<r;t++)n[t]=e[t];n[r]=128;const s=8*r;for(let t=0;t<8;t++)n[o-8+t]=s>>>8*t&255;const h=new Uint32Array(n.buffer),i=this.s;for(let t=0;t<8;t++)i[t]=this.iv[t],i[t+8]=2654435769^this.iv[t];for(let t=0;t<h.length;t+=16){for(let e=0;e<16;e++)i[e]^=h[t+e];for(let t=0;t<12;t++){const e=this.k[t%8],r=this.k[(t+3)%8];for(let t=0;t<4;t++){const o=4*t;let n=i[o],s=i[o+1],h=i[o+2],a=i[o+3];n=n+s+e>>>0,a^=n,a=this._rotl(a,16),h=h+a>>>0,s^=h,s=this._rotl(s,12),n=n+s+r>>>0,a^=n,a=this._rotl(a,8),h=h+a>>>0,s^=h,s=this._rotl(s,7),i[o]=n,i[o+1]=s,i[o+2]=h,i[o+3]=a}if(t%2==0){let t=i[1];i[1]=i[5],i[5]=i[9],i[9]=i[13],i[13]=t,t=i[2],i[2]=i[10],i[10]=t,t=i[3],i[3]=i[15],i[15]=i[11],i[11]=i[7],i[7]=t}}}let a="";for(let t=0;t<8;t++){const e=i[t];a+=String.fromCharCode(e>>>24&255,e>>>16&255,e>>>8&255,255&e)}const l="0123456789abcdef";let c="";for(let t=0;t<32;t++){const e=a.charCodeAt(t);c+=l[e>>>4&15]+l[15&e]}return c}hash256(t){return this.hash(t)}hash512(t){return this.hash(t)}static async benchmark(t=52428800){const e=new AetherWarp,r="x".repeat(t);for(let t=0;t<3;t++)e.hash256("warmup");const o=performance.now(),n=(e.hash256(r),performance.now()-o),s=(t/n/1024).toFixed(2);return console.log(`${(t/1024/1024).toFixed(2)} MB in ${n.toFixed(2)} ms`),console.log(`${s} MB/s (${(s/1024).toFixed(2)} GB/s)`),s}}"undefined"!=typeof window&&(window.AetherWarp=AetherWarp);
